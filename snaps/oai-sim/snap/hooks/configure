#!/bin/sh
set -e 

snapctl stop --disable ${SNAP_NAME}  2>&1  || true

if [ ! -f  $SNAP_DATA/.init ] ; then
    touch $SNAP_DATA/.init
    $SNAP/init
fi

ue=$(snapctl get conf.uesim)
if [ ! -z "$ue" ] ; then 
    $SNAP/conf set-ue $ue
fi

uecmd=$(snapctl get conf.uesimcmd)
if [ ! -z "$uecmd" ] ; then 
    $SNAP/conf set-ue-cmd $uecmd
fi

usim=$(snapctl get conf.usim)
if [ ! -z "$usim" ] ; then 
    $SNAP/conf set-usim $usim
fi

enb=$(snapctl get conf.enbsim)
if [ ! -z "$enb" ] ; then 
    $SNAP/conf set-enb $enb
fi

apiaddr=$(snapctl get conf.apiaddr)
if [ ! -z "$apiaddr" ] ; then 
    snapctl set conf.apiaddr=$apiaddr
fi

mgraddr=$(snapctl get conf.mgraddr)
if [ ! -z "$mgraddr" ] ; then 
    snapctl set conf.mgraddr=$mgraddr
fi
